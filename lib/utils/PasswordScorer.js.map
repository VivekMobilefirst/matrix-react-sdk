{"version":3,"file":"PasswordScorer.js","names":["ZXCVBN_USER_INPUTS","_td","scorePassword","password","length","userInputs","slice","MatrixClientPeg","get","push","getUserIdLocalpart","zxcvbnResult","zxcvbn","includes","resultNoSpaces","replace","score","i","feedback","suggestions","_t","warning"],"sources":["../../src/utils/PasswordScorer.ts"],"sourcesContent":["/*\nCopyright 2018 New Vector Ltd\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nimport zxcvbn, { ZXCVBNFeedbackWarning } from 'zxcvbn';\n\nimport { MatrixClientPeg } from '../MatrixClientPeg';\nimport { _t, _td } from '../languageHandler';\n\nconst ZXCVBN_USER_INPUTS = [\n    'riot',\n    'matrix',\n];\n\n// Translations for zxcvbn's suggestion strings\n_td(\"Use a few words, avoid common phrases\");\n_td(\"No need for symbols, digits, or uppercase letters\");\n_td(\"Use a longer keyboard pattern with more turns\");\n_td(\"Avoid repeated words and characters\");\n_td(\"Avoid sequences\");\n_td(\"Avoid recent years\");\n_td(\"Avoid years that are associated with you\");\n_td(\"Avoid dates and years that are associated with you\");\n_td(\"Capitalization doesn't help very much\");\n_td(\"All-uppercase is almost as easy to guess as all-lowercase\");\n_td(\"Reversed words aren't much harder to guess\");\n_td(\"Predictable substitutions like '@' instead of 'a' don't help very much\");\n_td(\"Add another word or two. Uncommon words are better.\");\n\n// and warnings\n_td(\"Repeats like \\\"aaa\\\" are easy to guess\");\n_td(\"Repeats like \\\"abcabcabc\\\" are only slightly harder to guess than \\\"abc\\\"\");\n_td(\"Sequences like abc or 6543 are easy to guess\");\n_td(\"Recent years are easy to guess\");\n_td(\"Dates are often easy to guess\");\n_td(\"This is a top-10 common password\");\n_td(\"This is a top-100 common password\");\n_td(\"This is a very common password\");\n_td(\"This is similar to a commonly used password\");\n_td(\"A word by itself is easy to guess\");\n_td(\"Names and surnames by themselves are easy to guess\");\n_td(\"Common names and surnames are easy to guess\");\n_td(\"Straight rows of keys are easy to guess\");\n_td(\"Short keyboard patterns are easy to guess\");\n\n/**\n * Wrapper around zxcvbn password strength estimation\n * Include this only from async components: it pulls in zxcvbn\n * (obviously) which is large.\n *\n * @param {string} password Password to score\n * @returns {object} Score result with `score` and `feedback` properties\n */\nexport function scorePassword(password: string) {\n    if (password.length === 0) return null;\n\n    const userInputs = ZXCVBN_USER_INPUTS.slice();\n    if (MatrixClientPeg.get()) {\n        userInputs.push(MatrixClientPeg.get().getUserIdLocalpart());\n    }\n\n    let zxcvbnResult = zxcvbn(password, userInputs);\n    // Work around https://github.com/dropbox/zxcvbn/issues/216\n    if (password.includes(' ')) {\n        const resultNoSpaces = zxcvbn(password.replace(/ /g, ''), userInputs);\n        if (resultNoSpaces.score < zxcvbnResult.score) zxcvbnResult = resultNoSpaces;\n    }\n\n    for (let i = 0; i < zxcvbnResult.feedback.suggestions.length; ++i) {\n        // translate suggestions\n        zxcvbnResult.feedback.suggestions[i] = _t(zxcvbnResult.feedback.suggestions[i]);\n    }\n    // and warning, if any\n    if (zxcvbnResult.feedback.warning) {\n        zxcvbnResult.feedback.warning = _t(zxcvbnResult.feedback.warning) as ZXCVBNFeedbackWarning;\n    }\n\n    return zxcvbnResult;\n}\n"],"mappings":";;;;;;;;;AAgBA;;AAEA;;AACA;;AAnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAOA,MAAMA,kBAAkB,GAAG,CACvB,MADuB,EAEvB,QAFuB,CAA3B,C,CAKA;;AACA,IAAAC,oBAAA,EAAI,uCAAJ;AACA,IAAAA,oBAAA,EAAI,mDAAJ;AACA,IAAAA,oBAAA,EAAI,+CAAJ;AACA,IAAAA,oBAAA,EAAI,qCAAJ;AACA,IAAAA,oBAAA,EAAI,iBAAJ;AACA,IAAAA,oBAAA,EAAI,oBAAJ;AACA,IAAAA,oBAAA,EAAI,0CAAJ;AACA,IAAAA,oBAAA,EAAI,oDAAJ;AACA,IAAAA,oBAAA,EAAI,uCAAJ;AACA,IAAAA,oBAAA,EAAI,2DAAJ;AACA,IAAAA,oBAAA,EAAI,4CAAJ;AACA,IAAAA,oBAAA,EAAI,wEAAJ;AACA,IAAAA,oBAAA,EAAI,qDAAJ,E,CAEA;;AACA,IAAAA,oBAAA,EAAI,wCAAJ;AACA,IAAAA,oBAAA,EAAI,2EAAJ;AACA,IAAAA,oBAAA,EAAI,8CAAJ;AACA,IAAAA,oBAAA,EAAI,gCAAJ;AACA,IAAAA,oBAAA,EAAI,+BAAJ;AACA,IAAAA,oBAAA,EAAI,kCAAJ;AACA,IAAAA,oBAAA,EAAI,mCAAJ;AACA,IAAAA,oBAAA,EAAI,gCAAJ;AACA,IAAAA,oBAAA,EAAI,6CAAJ;AACA,IAAAA,oBAAA,EAAI,mCAAJ;AACA,IAAAA,oBAAA,EAAI,oDAAJ;AACA,IAAAA,oBAAA,EAAI,6CAAJ;AACA,IAAAA,oBAAA,EAAI,yCAAJ;AACA,IAAAA,oBAAA,EAAI,2CAAJ;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASC,aAAT,CAAuBC,QAAvB,EAAyC;EAC5C,IAAIA,QAAQ,CAACC,MAAT,KAAoB,CAAxB,EAA2B,OAAO,IAAP;EAE3B,MAAMC,UAAU,GAAGL,kBAAkB,CAACM,KAAnB,EAAnB;;EACA,IAAIC,gCAAA,CAAgBC,GAAhB,EAAJ,EAA2B;IACvBH,UAAU,CAACI,IAAX,CAAgBF,gCAAA,CAAgBC,GAAhB,GAAsBE,kBAAtB,EAAhB;EACH;;EAED,IAAIC,YAAY,GAAG,IAAAC,eAAA,EAAOT,QAAP,EAAiBE,UAAjB,CAAnB,CAR4C,CAS5C;;EACA,IAAIF,QAAQ,CAACU,QAAT,CAAkB,GAAlB,CAAJ,EAA4B;IACxB,MAAMC,cAAc,GAAG,IAAAF,eAAA,EAAOT,QAAQ,CAACY,OAAT,CAAiB,IAAjB,EAAuB,EAAvB,CAAP,EAAmCV,UAAnC,CAAvB;IACA,IAAIS,cAAc,CAACE,KAAf,GAAuBL,YAAY,CAACK,KAAxC,EAA+CL,YAAY,GAAGG,cAAf;EAClD;;EAED,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,YAAY,CAACO,QAAb,CAAsBC,WAAtB,CAAkCf,MAAtD,EAA8D,EAAEa,CAAhE,EAAmE;IAC/D;IACAN,YAAY,CAACO,QAAb,CAAsBC,WAAtB,CAAkCF,CAAlC,IAAuC,IAAAG,mBAAA,EAAGT,YAAY,CAACO,QAAb,CAAsBC,WAAtB,CAAkCF,CAAlC,CAAH,CAAvC;EACH,CAlB2C,CAmB5C;;;EACA,IAAIN,YAAY,CAACO,QAAb,CAAsBG,OAA1B,EAAmC;IAC/BV,YAAY,CAACO,QAAb,CAAsBG,OAAtB,GAAgC,IAAAD,mBAAA,EAAGT,YAAY,CAACO,QAAb,CAAsBG,OAAzB,CAAhC;EACH;;EAED,OAAOV,YAAP;AACH"}